{"ast":null,"code":"module.exports = function (size) {\n  return new LruCache(size);\n};\n\nfunction LruCache(size) {\n  this.capacity = size | 0;\n  this.map = Object.create(null);\n  this.list = new DoublyLinkedList();\n}\n\nLruCache.prototype.get = function (key) {\n  var node = this.map[key];\n  if (node == null) return undefined;\n  this.used(node);\n  return node.val;\n};\n\nLruCache.prototype.set = function (key, val) {\n  var node = this.map[key];\n\n  if (node != null) {\n    node.val = val;\n  } else {\n    if (!this.capacity) this.prune();\n    if (!this.capacity) return false;\n    node = new DoublyLinkedNode(key, val);\n    this.map[key] = node;\n    this.capacity--;\n  }\n\n  this.used(node);\n  return true;\n};\n\nLruCache.prototype.used = function (node) {\n  this.list.moveToFront(node);\n};\n\nLruCache.prototype.prune = function () {\n  var node = this.list.pop();\n\n  if (node != null) {\n    delete this.map[node.key];\n    this.capacity++;\n  }\n};\n\nfunction DoublyLinkedList() {\n  this.firstNode = null;\n  this.lastNode = null;\n}\n\nDoublyLinkedList.prototype.moveToFront = function (node) {\n  if (this.firstNode == node) return;\n  this.remove(node);\n\n  if (this.firstNode == null) {\n    this.firstNode = node;\n    this.lastNode = node;\n    node.prev = null;\n    node.next = null;\n  } else {\n    node.prev = null;\n    node.next = this.firstNode;\n    node.next.prev = node;\n    this.firstNode = node;\n  }\n};\n\nDoublyLinkedList.prototype.pop = function () {\n  var lastNode = this.lastNode;\n\n  if (lastNode != null) {\n    this.remove(lastNode);\n  }\n\n  return lastNode;\n};\n\nDoublyLinkedList.prototype.remove = function (node) {\n  if (this.firstNode == node) {\n    this.firstNode = node.next;\n  } else if (node.prev != null) {\n    node.prev.next = node.next;\n  }\n\n  if (this.lastNode == node) {\n    this.lastNode = node.prev;\n  } else if (node.next != null) {\n    node.next.prev = node.prev;\n  }\n};\n\nfunction DoublyLinkedNode(key, val) {\n  this.key = key;\n  this.val = val;\n  this.prev = null;\n  this.next = null;\n}","map":{"version":3,"names":["module","exports","size","LruCache","capacity","map","Object","create","list","DoublyLinkedList","prototype","get","key","node","undefined","used","val","set","prune","DoublyLinkedNode","moveToFront","pop","firstNode","lastNode","remove","prev","next"],"sources":["/home/cyrus/WebstormProjects/bigbull/client/node_modules/aws4/lru.js"],"sourcesContent":["module.exports = function(size) {\n  return new LruCache(size)\n}\n\nfunction LruCache(size) {\n  this.capacity = size | 0\n  this.map = Object.create(null)\n  this.list = new DoublyLinkedList()\n}\n\nLruCache.prototype.get = function(key) {\n  var node = this.map[key]\n  if (node == null) return undefined\n  this.used(node)\n  return node.val\n}\n\nLruCache.prototype.set = function(key, val) {\n  var node = this.map[key]\n  if (node != null) {\n    node.val = val\n  } else {\n    if (!this.capacity) this.prune()\n    if (!this.capacity) return false\n    node = new DoublyLinkedNode(key, val)\n    this.map[key] = node\n    this.capacity--\n  }\n  this.used(node)\n  return true\n}\n\nLruCache.prototype.used = function(node) {\n  this.list.moveToFront(node)\n}\n\nLruCache.prototype.prune = function() {\n  var node = this.list.pop()\n  if (node != null) {\n    delete this.map[node.key]\n    this.capacity++\n  }\n}\n\n\nfunction DoublyLinkedList() {\n  this.firstNode = null\n  this.lastNode = null\n}\n\nDoublyLinkedList.prototype.moveToFront = function(node) {\n  if (this.firstNode == node) return\n\n  this.remove(node)\n\n  if (this.firstNode == null) {\n    this.firstNode = node\n    this.lastNode = node\n    node.prev = null\n    node.next = null\n  } else {\n    node.prev = null\n    node.next = this.firstNode\n    node.next.prev = node\n    this.firstNode = node\n  }\n}\n\nDoublyLinkedList.prototype.pop = function() {\n  var lastNode = this.lastNode\n  if (lastNode != null) {\n    this.remove(lastNode)\n  }\n  return lastNode\n}\n\nDoublyLinkedList.prototype.remove = function(node) {\n  if (this.firstNode == node) {\n    this.firstNode = node.next\n  } else if (node.prev != null) {\n    node.prev.next = node.next\n  }\n  if (this.lastNode == node) {\n    this.lastNode = node.prev\n  } else if (node.next != null) {\n    node.next.prev = node.prev\n  }\n}\n\n\nfunction DoublyLinkedNode(key, val) {\n  this.key = key\n  this.val = val\n  this.prev = null\n  this.next = null\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}